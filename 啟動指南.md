# Schedule System 啟動指南

## 🚀 快速啟動步驟

### 1. 準備工作

確認 Node.js 已安裝：
- 關閉目前的 PowerShell 視窗
- 重新開啟一個新的 PowerShell 視窗
- 輸入 `node --version` 確認安裝成功

### 2. 啟動後端服務

在專案根目錄執行：

```powershell
go run main.go
```

後端將在 `http://localhost:8080` 啟動

### 3. 安裝前端依賴

開啟**新的** PowerShell 視窗，進入前端目錄：

```powershell
cd d:\app\schedule-system\frontend
npm install
```

安裝完成後執行：

```powershell
npm run dev
```

前端將在 `http://localhost:3000` 啟動

### 4. 訪問系統

在瀏覽器開啟：`http://localhost:3000`

---

## 📋 初始化測試資料

### 方法一：使用現有資料庫的使用者

如果資料庫中已有使用者（如 Jack），可以直接使用前端的「使用者管理」頁面選擇使用者。

### 方法二：建立新使用者

使用 Postman 或 curl 建立新使用者：

```bash
curl -X POST http://localhost:8080/api/v1/users/ \
  -H "Content-Type: application/json" \
  -d '{
    "name": "測試員工A",
    "email": "employeeA@example.com",
    "role": "employee",
    "status": 1
  }'
```

### 方法三：設定班表需求

設定某日的班表需求（管理員功能）：

```bash
# 設定 2025-11-21 早班需要 3 人
curl -X POST http://localhost:8080/api/v1/shifts/requirements \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-11-21",
    "shift_type": "morning",
    "required_count": 3
  }'

# 設定 2025-11-21 中班需要 2 人
curl -X POST http://localhost:8080/api/v1/shifts/requirements \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-11-21",
    "shift_type": "afternoon",
    "required_count": 2
  }'

# 設定 2025-11-21 晚班需要 2 人
curl -X POST http://localhost:8080/api/v1/shifts/requirements \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-11-21",
    "shift_type": "evening",
    "required_count": 2
  }'
```

---

## 🧪 測試流程

1. **進入使用者管理頁面**
   - 點擊左側選單「使用者管理」
   - 選擇一個使用者作為當前操作者

2. **進入排班行事曆**
   - 點擊左側選單「班表行事曆」
   - 查看統計資訊（今日需求、已排班、缺額）

3. **預約班別**
   - 點擊行事曆上任一日期
   - 在彈出視窗中選擇班別（早/中/晚）
   - 點擊確定完成預約

4. **查看結果**
   - 行事曆上該日期會顯示更新的人數
   - 例如：早班 1/3（表示需要3人，已預約1人）

---

## ⚠️ 常見問題

### Q: npm 指令找不到？
**A**: 請重新開啟 PowerShell 視窗，Node.js 安裝後需要重新載入環境變數。

### Q: 後端連線資料庫失敗？
**A**: 確認 MySQL 服務正在運行，並且資料庫 `schedule_system` 已建立。

### Q: 前端無法連接後端？
**A**: 確認後端服務已在 8080 port 啟動，檢查是否有防火牆阻擋。

### Q: 行事曆沒有顯示班表資料？
**A**: 請先使用 API 設定至少一天的班表需求（參考上方「初始化測試資料」）。

---

## 🔧 進階設定

### 修改後端 Port

編輯 `main.go`：
```go
router.Run(":8080")  // 改為其他 port，如 ":9000"
```

### 修改前端代理設定

編輯 `frontend/vite.config.ts`：
```typescript
proxy: {
  '/api': {
    target: 'http://localhost:8080',  // 改為後端實際位址
    changeOrigin: true,
  },
}
```

---

## 📦 建置生產版本

### 前端建置

```powershell
cd frontend
npm run build
```

建置後的檔案位於 `frontend/dist` 目錄。

### 後端編譯

```powershell
go build -o schedule-system.exe
```

執行編譯後的程式：
```powershell
.\schedule-system.exe
```
